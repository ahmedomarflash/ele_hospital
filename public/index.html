<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Healthy Parental</title>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@600&display=swap" rel="stylesheet" />
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: 'Cairo', sans-serif;
    }
    body {
      min-height: 100vh;
      background: radial-gradient(circle at center, #203a43, #0f2027);
      color: #e0f7f7;
      overflow-x: hidden;
      position: relative;
    }
    #glow-overlay {
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 0;
    }
    #topBar {
      width: 100vw;
      background: rgba(0, 47, 47, 0.95);
      box-shadow: 0 2px 16px #00fff7aa;
      position: fixed;
      top: 0; left: 0;
      z-index: 100;
      padding: 0;
      display: none;
    }
    #topBar .bar-content {
      display: flex;
      align-items: center;
      justify-content: flex-end;
      gap: 18px;
      max-width: 1100px;
      margin: 0 auto;
      padding: 10px 24px;
    }
    #userAvatar {
      width: 38px;
      height: 38px;
      border-radius: 50%;
      background: #e0f7f7;
      object-fit: cover;
      border: 2px solid #00fff7;
    }
    #userEmail {
      color: #aaf0f0;
      font-size: 1.1rem;
      font-weight: 700;
      direction: ltr;
      margin-left: 10px;
    }
    #topBar button {
      background: linear-gradient(135deg, #00bcd4, #00fff7);
      border: none;
      padding: 7px 18px;
      font-size: 1rem;
      font-weight: 700;
      border-radius: 10px;
      cursor: pointer;
      color: #002f2f;
      margin-left: 8px;
      box-shadow: 0 0 8px #00fff7cc;
      transition: background 0.2s;
    }
    #topBar button:hover {
      background: linear-gradient(135deg, #00fff7, #00bcd4);
    }
    #authCenter {
      position: fixed;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10;
      background: transparent;
    }
    #authForm {
      background: rgba(0, 255, 247, 0.1);
      box-shadow: 0 0 20px #00fff7bb;
      border-radius: 16px;
      padding: 30px 25px;
      max-width: 350px;
      width: 100%;
      text-align: right;
      z-index: 11;
      position: relative;
    }
    label {
      display: block;
      margin-bottom: 10px;
      font-weight: 600;
      font-size: 18px;
    }
    input[type="email"],
    input[type="password"] {
      width: 100%;
      padding: 12px 15px;
      border-radius: 12px;
      border: none;
      font-size: 17px;
      margin-bottom: 22px;
      background-color: #002f2f;
      color: #aaf0f0;
      box-shadow: inset 0 0 10px #00fff7cc;
    }
    input[type="email"]:focus,
    input[type="password"]:focus {
      outline: none;
      box-shadow: 0 0 20px #00fff7ff;
      background-color: #004c4c;
      color: #e0f7f7;
    }
    button {
      width: 100%;
      background: linear-gradient(135deg, #00bcd4, #00fff7);
      border: none;
      padding: 14px 0;
      font-size: 20px;
      font-weight: 700;
      border-radius: 14px;
      cursor: pointer;
      color: #002f2f;
      margin-bottom: 10px;
      box-shadow: 0 0 15px #00fff7cc;
    }
    button:hover {
      background: linear-gradient(135deg, #00fff7, #00bcd4);
      box-shadow: 0 0 30px #00fff7ff, 0 0 50px #00bcd4ff;
    }
    #googleSignInBtn {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      background: #fff;
      color: #222;
      border: 1px solid #00fff7;
      margin-bottom: 16px;
      font-weight: 700;
      font-size: 16px;
      box-shadow: 0 0 8px #00fff7cc;
      transition: background 0.2s;
    }
    #googleSignInBtn:hover {
      background: #e0f7f7;
    }
    #googleSignInBtn img {
      width: 22px;
      height: 22px;
      vertical-align: middle;
    }
    #message {
      margin-top:10px;
      color:#ff8080;
      font-size:14px;
      min-height: 18px;
      text-align: center;
    }
    header, main {
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.5s ease;
      z-index: 1;
      position: relative;
      display: block;
    }
    header.visible, main.visible {
      opacity: 1;
      pointer-events: auto;
    }
    header h1 {
      font-size: 3.8rem;
      margin-bottom: 40px;
      color: #00fff7;
      text-shadow: 0 0 10px #00fff7, 0 0 20px #00fff7, 0 0 40px #00fff7, 0 0 80px #00fff7;
      letter-spacing: 3px;
      text-align: center;
    }
    .content-with-images {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 40px;
      max-width: 1000px;
      margin: 40px auto;
    }
    .side-column {
      display: flex;
      flex-direction: column;
      gap: 20px;
    }
    .side-column img {
      width: 260px;
      height: 160px;
      border-radius: 16px;
      object-fit: cover;
      box-shadow: 0 0 15px #00fff7aa, 0 0 30px #00fff7cc;
      transition: transform 0.4s ease, box-shadow 0.4s ease;
      cursor: pointer;
    }
    .side-column img:hover {
      transform: scale(1.05);
      box-shadow: 0 0 25px #00fff7dd, 0 0 50px #00fff7ee;
    }
    .center-text {
      max-width: 380px;
      font-size: 1.2rem;
      line-height: 1.7;
      font-weight: 600;
      text-align: center;
      color: #aaf0f0;
      padding: 15px;
      border: 2px solid #00fff7aa;
      border-radius: 14px;
      background: rgba(0, 255, 247, 0.1);
    }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
</head>
<body>
<div id="glow-overlay"></div>

<!-- Top Bar (hidden by default) -->
<nav id="topBar">
  <div class="bar-content">
    <img id="userAvatar" src="" alt="User Avatar" />
    <span id="userEmail"></span>
    <button id="changePassBtn" type="button">تغيير كلمة المرور</button>
    <button id="signOutBtn" type="button">تسجيل الخروج</button>
  </div>
</nav>

<!-- Centered Auth Wrapper -->
<div id="authCenter">
  <form id="authForm">
    <label for="email">البريد الإلكتروني</label>
    <input type="email" id="email" placeholder="example@mail.com" required />
    <label for="password">كلمة المرور</label>
    <input type="password" id="password" placeholder="••••••••" required />
    <button id="googleSignInBtn" type="button">
      <img src="https://upload.wikimedia.org/wikipedia/commons/5/53/Google_%22G%22_Logo.svg" alt="Google">
      <span>الدخول عبر Google</span>
    </button>
    <button id="signInBtn" type="button">تسجيل الدخول</button>
    <button id="signUpBtn" type="button">إنشاء حساب</button>
    <div id="message"></div>
  </form>
</div>

<header>
  <h1>Healthy Parental</h1>
</header>
<main>
  <section class="content-with-images">
    <div class="side-column">
      <img src="https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=500&q=90" />
      <img src="https://images.unsplash.com/photo-1504384308090-c894fdcc538d?auto=format&fit=crop&w=500&q=90" />
    </div>
    <div class="center-text">
      Good health is essential for a happy life. Maintaining a balanced diet, regular exercise, and sufficient rest can improve your well-being and energy.
    </div>
    <div class="side-column">
      <img src="https://images.unsplash.com/photo-1498837167922-ddd27525d352?auto=format&fit=crop&w=500&q=90" />
      <img src="https://images.unsplash.com/photo-1515377905703-c4788e51af15?auto=format&fit=crop&w=500&q=90" />
    </div>
  </section>
</main>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-app.js";
  import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, sendPasswordResetEmail, signOut, GoogleAuthProvider, signInWithPopup } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-auth.js";

  const firebaseConfig = {
    apiKey: "AIzaSyAtb4EIuHEZF-IoAWYiq3zE-qYuUvP4Wgo",
    authDomain: "sign-in-properly.firebaseapp.com",
    projectId: "sign-in-properly",
    storageBucket: "sign-in-properly.appspot.com",
    messagingSenderId: "431658776093",
    appId: "1:431658776093:web:df81018d7f4b76d74bf8f4",
    measurementId: "G-WC4VPBD4T4"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);

  const emailInput = document.getElementById('email');
  const passInput = document.getElementById('password');
  const signInBtn = document.getElementById('signInBtn');
  const signUpBtn = document.getElementById('signUpBtn');
  const googleSignInBtn = document.getElementById('googleSignInBtn');
  const message = document.getElementById('message');
  const authCenter = document.getElementById('authCenter');
  const header = document.querySelector('header');
  const main = document.querySelector('main');
  const topBar = document.getElementById('topBar');
  const userEmailSpan = document.getElementById('userEmail');
  const userAvatar = document.getElementById('userAvatar');
  const signOutBtn = document.getElementById('signOutBtn');
  const changePassBtn = document.getElementById('changePassBtn');

  function getGoogleAvatar(email, photoURL) {
    // Use Firebase photoURL if available (Google sign-in)
    if (photoURL) return photoURL;
    // For Gmail, show Google "G" logo
    if (email.endsWith('@gmail.com')) {
      return "https://upload.wikimedia.org/wikipedia/commons/5/53/Google_%22G%22_Logo.svg";
    }
    // Fallback to Gravatar
    const md5 = email => {
      return window.CryptoJS.MD5(email.trim().toLowerCase()).toString();
    };
    return `https://www.gravatar.com/avatar/${md5(email)}?d=identicon`;
  }

  signInBtn.addEventListener('click', () => {
    message.textContent = '';
    signInWithEmailAndPassword(auth, emailInput.value, passInput.value)
      .then(() => showContent())
      .catch(err => message.textContent = err.message);
  });

  signUpBtn.addEventListener('click', () => {
    message.textContent = '';
    createUserWithEmailAndPassword(auth, emailInput.value, passInput.value)
      .then(() => showContent())
      .catch(err => message.textContent = err.message);
  });

  // Google Sign-In
  if (googleSignInBtn) {
    googleSignInBtn.onclick = async () => {
      message.textContent = '';
      const provider = new GoogleAuthProvider();
      try {
        await signInWithPopup(auth, provider);
        showContent();
      } catch (err) {
        message.textContent = err.message;
      }
    };
  }

  function showContent() {
    authCenter.style.display = 'none';
    header.classList.add('visible');
    main.classList.add('visible');
    topBar.style.display = 'block';

    // Show user info
    const user = auth.currentUser;
    if (user) {
      userEmailSpan.textContent = user.email || '';
      userAvatar.src = getGoogleAvatar(user.email || '', user.photoURL || '');
    }
  }

  // Sign out
  if (signOutBtn) {
    signOutBtn.onclick = () => {
      signOut(auth).then(() => {
        topBar.style.display = 'none';
        header.classList.remove('visible');
        main.classList.remove('visible');
        authCenter.style.display = 'flex';
        document.getElementById('authForm').reset();
      });
    };
  }

  // Change password
  if (changePassBtn) {
    changePassBtn.onclick = () => {
      const user = auth.currentUser;
      if (user && user.email) {
        sendPasswordResetEmail(auth, user.email)
          .then(() => alert('تم إرسال رابط تغيير كلمة المرور إلى بريدك الإلكتروني.'))
          .catch(err => alert('حدث خطأ: ' + err.message));
      }
    };
  }

  // Glow mouse effect
  const glowOverlay = document.getElementById('glow-overlay');
  document.addEventListener('mousemove', e => {
    glowOverlay.style.background = `radial-gradient(circle at ${e.clientX}px ${e.clientY}px, rgba(0,255,247,0.4) 0%, transparent 15%)`;
  });
</script>
</body>
</html>
