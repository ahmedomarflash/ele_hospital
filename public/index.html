<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Healthy Parental â€” Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</title>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet" />
  <style>
    /* =============================================================
       Base + Layout
       ============================================================= */
    html,
    body {
      height: 100%;
      margin: 0;
      padding: 0;
      font-family: 'Cairo', sans-serif;
    }

    body {
      min-height: 100vh;
      background: linear-gradient(135deg, #232526 0%, #414345 100%);
      background-attachment: fixed;
      color: #e0f7f7;
      overflow-x: hidden;
      overflow-y: auto;
      position: relative;
      padding-top: 70px; /* space for top bar when visible */
    }

    /* =============================================================
       Bubbles Background
       ============================================================= */
    #bubbles-bg {
      position: fixed;
      inset: 0;
      z-index: 0;
      overflow: hidden;
      pointer-events: none;
    }

    .bubble {
      position: absolute;
      border-radius: 50%;
      opacity: 0.16;
      background: radial-gradient(circle at 60% 40%, #00fff7 0%, #00bcd4 80%, transparent 100%);
      animation: floatBubble 18s linear infinite;
      pointer-events: none;
      filter: blur(1.5px);
      mix-blend-mode: lighten;
    }

    .bubble2 {
      background: radial-gradient(circle at 40% 60%, #fff 0%, #00fff7 60%, transparent 100%);
      opacity: 0.10;
      filter: blur(3px);
      mix-blend-mode: lighten;
    }

    @keyframes floatBubble {
      0% {
        transform: translateY(100vh) scale(1);
        opacity: 0.16;
      }
      80% {
        opacity: 0.22;
      }
      100% {
        transform: translateY(-120vh) scale(1.2);
        opacity: 0;
      }
    }

    #glow-overlay {
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 1;
    }

    /* =============================================================
       Top Bar (Hidden by default; shown after login)
       ============================================================= */
    #topBar {
      width: 100vw;
      background: #002f2f;
      box-shadow: 0 2px 16px #00fff7aa;
      position: fixed;
      top: 0;
      left: 0;
      z-index: 100;
      padding: 0;
      height: 70px;
      display: none; /* shown post-login */
    }

    #topBar .bar-content {
      display: flex;
      align-items: center;
      justify-content: flex-end;
      gap: 18px;
      max-width: 1100px;
      margin: 0 auto;
      padding: 10px 24px;
      height: 100%;
    }

    #userAvatar {
      width: 38px;
      height: 38px;
      border-radius: 50%;
      background: #e0f7f7;
      object-fit: cover;
      border: 2px solid #00fff7;
    }

    #userEmail {
      color: #aaf0f0;
      font-size: 1.1rem;
      font-weight: 700;
      direction: ltr;
      margin-left: 10px;
      font-family: 'Cairo', sans-serif;
    }

    #topBar button {
      background: linear-gradient(135deg, #00bcd4, #00fff7);
      border: none;
      padding: 7px 18px;
      font-size: 1rem;
      font-weight: 700;
      border-radius: 10px;
      cursor: pointer;
      color: #002f2f;
      margin-left: 8px;
      box-shadow: 0 0 8px #00fff7cc;
      transition: background 0.2s;
      font-family: 'Cairo', sans-serif;
    }

    #topBar button:hover {
      background: linear-gradient(135deg, #00fff7, #00bcd4);
    }

    /* =============================================================
       Main Container
       ============================================================= */
    #mainBox {
      position: relative;
      z-index: 2;
      max-width: 1050px;
      margin: 90px auto 40px auto;
      background: rgba(30, 40, 45, 0.97);
      border-radius: 28px;
      box-shadow: 0 0 40px #00fff7bb, 0 8px 32px #002f2f44;
      padding: 40px 32px 32px 32px;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 0;
    }

    /* =============================================================
       Auth Box (centered)
       ============================================================= */
    #authCenter {
      position: static;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10;
      background: none;
      width: 100%;
      margin-bottom: 30px;
    }

    #authForm {
      background: rgba(0, 47, 47, 0.97);
      box-shadow: 0 0 32px #00fff7bb, 0 8px 32px #002f2f44;
      border-radius: 22px;
      padding: 38px 32px 28px 32px;
      max-width: 370px;
      width: 100%;
      text-align: right;
      z-index: 11;
      position: relative;
      font-family: 'Cairo', sans-serif;
      display: flex;
      flex-direction: column;
      align-items: stretch;
      justify-content: center;
      margin-left: 0;
      margin-right: 0;
      min-height: 0;
    }

    #authForm h2 {
      text-align: center;
      font-family: 'Cairo', sans-serif;
      font-weight: 700;
      color: #00fff7;
      margin-bottom: 18px;
      font-size: 2rem;
    }

    label {
      display: block;
      margin-bottom: 10px;
      font-weight: 600;
      font-size: 18px;
      font-family: 'Cairo', sans-serif;
    }

    input[type="email"],
    input[type="password"] {
      width: 100%;
      box-sizing: border-box;
      padding: 12px 15px;
      border-radius: 12px;
      border: none;
      font-size: 17px;
      margin-bottom: 22px;
      background-color: #002f2f;
      color: #aaf0f0;
      box-shadow: inset 0 0 10px #00fff7cc;
      font-family: 'Cairo', sans-serif;
      margin-right: 0;
      margin-left: 0;
      transition: background 0.2s, color 0.2s;
    }

    input[type="email"]:focus,
    input[type="password"]:focus {
      outline: none;
      box-shadow: 0 0 20px #00fff7ff;
      background-color: #004c4c;
      color: #e0f7f7;
    }

    button {
      width: 100%;
      background: linear-gradient(135deg, #00bcd4, #00fff7);
      border: none;
      padding: 14px 0;
      font-size: 20px;
      font-weight: 700;
      border-radius: 14px;
      cursor: pointer;
      color: #002f2f;
      margin-bottom: 10px;
      box-shadow: 0 0 15px #00fff7cc;
      font-family: 'Cairo', sans-serif;
      transition: background 0.2s;
    }

    button:hover {
      background: linear-gradient(135deg, #00fff7, #00bcd4);
      box-shadow: 0 0 30px #00fff7ff, 0 0 50px #00bcd4ff;
    }

    #googleSignInBtn {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      background: #fff;
      color: #222;
      border: 1px solid #00fff7;
      margin-bottom: 16px;
      font-weight: 700;
      font-size: 16px;
      box-shadow: 0 0 8px #00fff7cc;
      transition: background 0.2s;
      font-family: 'Cairo', sans-serif;
    }

    #googleSignInBtn:hover {
      background: #e0f7f7;
    }

    #googleSignInBtn img {
      width: 22px;
      height: 22px;
      vertical-align: middle;
    }

    #message {
      margin-top: 10px;
      color: #ff8080;
      font-size: 14px;
      min-height: 18px;
      text-align: center;
      font-family: 'Cairo', sans-serif;
    }

    .or-divider {
      margin: 16px 0 8px 0;
      text-align: center;
      color: #aaa;
      font-family: 'Cairo', sans-serif;
    }

    /* =============================================================
       Role chooser (post-login, pre-site-content)
       ============================================================= */
    #chooseRolePage {
      display: none; /* becomes flex after login */
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 400px;
    }

    /* =============================================================
       Site content visibility control (hidden until role chosen)
       ============================================================= */
    header,
    main {
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.5s ease;
      z-index: 1;
      position: relative;
      display: block;
    }

    header.visible,
    main.visible {
      opacity: 1;
      pointer-events: auto;
    }

    header h1 {
      font-size: 3.2rem;
      margin-bottom: 28px;
      color: #00fff7;
      text-shadow: 0 0 10px #00fff7, 0 0 20px #00fff7, 0 0 40px #00fff7, 0 0 80px #00fff7;
      letter-spacing: 2px;
      text-align: center;
      font-family: 'Cairo', sans-serif;
    }

    /* =============================================================
       Patient Form (sits at the top of the site content)
       ============================================================= */
    #patientFormBox {
      width: 100%;
      background: rgba(0, 47, 47, 0.97);
      border-radius: 22px;
      box-shadow: 0 0 28px #00fff7aa, 0 8px 22px #002f2f44;
      padding: 26px 22px;
      margin-bottom: 36px; /* ensure content below follows */
      display: block; /* will be toggled by JS */
    }

    #patientFormBox .form-section {
      margin-bottom: 26px;
    }

    #patientFormBox .form-section h2 {
      color: #00fff7;
      text-shadow: 0 0 10px #00fff7;
      font-size: 1.6rem;
      margin-bottom: 16px;
      text-align: center;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }

    #patientFormBox .form-group {
      margin-bottom: 16px;
    }

    #patientFormBox label {
      color: #aaf0f0;
      font-weight: 600;
      margin-bottom: 8px;
    }

    #patientFormBox input[type="text"],
    #patientFormBox input[type="date"],
    #patientFormBox input[type="tel"],
    #patientFormBox input[type="email"],
    #patientFormBox input[type="time"],
    #patientFormBox select,
    #patientFormBox textarea {
      width: 100%;
      padding: 12px 15px;
      border-radius: 12px;
      border: none;
      font-size: 16px;
      background-color: #002f2f;
      color: #e0f7f7;
      box-shadow: inset 0 0 10px #00fff7cc;
      font-family: 'Cairo', sans-serif;
      transition: all 0.3s;
    }

    #patientFormBox input:focus,
    #patientFormBox select:focus,
    #patientFormBox textarea:focus {
      outline: none;
      box-shadow: 0 0 20px #00fff7ff;
      background-color: #004c4c;
    }

    #patientFormBox textarea {
      min-height: 100px;
      resize: vertical;
    }

    #patientFormBox select {
      appearance: none;
      background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%2300fff7'%3e%3cpath d='M7 10l5 5 5-5z'/%3e%3c/svg%3e");
      background-repeat: no-repeat;
      background-position: right 15px center;
      background-size: 20px;
    }

    #patientFormBox .submit-btn {
      width: 100%;
      background: linear-gradient(135deg, #00bcd4, #00fff7);
      border: none;
      padding: 14px 0;
      font-size: 18px;
      font-weight: 700;
      border-radius: 14px;
      cursor: pointer;
      color: #002f2f;
      margin-top: 10px;
      box-shadow: 0 0 15px #00fff7cc;
      font-family: 'Cairo', sans-serif;
      transition: background 0.2s;
    }

    #patientFormBox .submit-btn:hover {
      background: linear-gradient(135deg, #00fff7, #00bcd4);
      box-shadow: 0 0 24px #00fff7ff;
    }

    #patientFormSuccess {
      text-align: center;
      color: #00fff7;
      min-height: 20px;
      margin-top: 8px;
      font-weight: 700;
    }

    /* =============================================================
       Content with side images + center text (below the form)
       ============================================================= */
    .content-with-images {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 40px;
      max-width: 1000px;
      margin: 40px auto;
    }

    .side-column {
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .side-column img {
      width: 260px;
      height: 160px;
      border-radius: 16px;
      object-fit: cover;
      box-shadow: 0 0 15px #00fff7aa, 0 0 30px #00fff7cc;
      transition: transform 0.4s ease, box-shadow 0.4s ease;
      cursor: pointer;
      background: #fff;
    }

    .side-column img:hover {
      transform: scale(1.05);
      box-shadow: 0 0 25px #00fff7dd, 0 0 50px #00fff7ee;
    }

    .center-text {
      max-width: 380px;
      font-size: 1.2rem;
      line-height: 1.7;
      font-weight: 600;
      text-align: center;
      color: #aaf0f0;
      padding: 15px;
      border: 2px solid #00fff7aa;
      border-radius: 14px;
      background: rgba(0, 255, 247, 0.1);
      font-family: 'Cairo', sans-serif;
    }

    /* =============================================================
       Market Section
       ============================================================= */
    #market-section {
      margin: 50px auto 0 auto;
      max-width: 1000px;
      width: 100%;
    }

    #marketGrid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 32px;
      margin-top: 20px;
    }

    .medicine-card {
      background: #002f2f;
      border-radius: 16px;
      box-shadow: 0 0 16px #00fff799;
      padding: 18px 12px 16px 12px;
      display: flex;
      flex-direction: column;
      align-items: center;
      transition: transform 0.3s, box-shadow 0.3s;
    }

    .medicine-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 0 25px #00fff7dd;
    }

    .medicine-card img {
      width: 100px;
      height: 100px;
      object-fit: cover;
      border-radius: 12px;
      box-shadow: 0 0 10px #00fff7cc;
      background: #fff;
    }

    .medicine-name {
      margin: 14px 0 8px 0;
      font-size: 1.15rem;
      color: #00fff7;
      font-weight: 700;
      text-align: center;
    }

    .medicine-price {
      font-size: 1.1rem;
      color: #aaf0f0;
      margin-bottom: 10px;
    }

    .add-to-cart-btn {
      width: 90%;
      font-size: 1.1rem;
      background: linear-gradient(135deg, #00bcd4, #00fff7);
      border: none;
      padding: 8px 0;
      border-radius: 8px;
      color: #002f2f;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s;
    }

    .add-to-cart-btn:hover {
      box-shadow: 0 0 15px #00fff7;
    }

    /* =============================================================
       Floating Cart Icon
       ============================================================= */
    .cart-icon {
      position: fixed;
      bottom: 30px;
      right: 30px;
      background: #00fff7;
      width: 60px;
      height: 60px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 0 20px #00fff7;
      cursor: pointer;
      z-index: 100;
      font-size: 1.5rem;
      transition: transform 0.2s ease;
    }

    .cart-count {
      position: absolute;
      top: -5px;
      right: -5px;
      background: #ff4081;
      color: white;
      width: 25px;
      height: 25px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      font-size: 0.9rem;
    }

    /* =============================================================
       Responsive Tweaks
       ============================================================= */
    @media (max-width: 1200px) {
      #mainBox {
        max-width: 98vw;
        padding: 20px 2vw 20px 2vw;
      }
    }

    @media (max-width: 900px) {
      #mainBox {
        flex-direction: column;
        align-items: center;
        padding: 10px 0 10px 0;
      }
      #authCenter {
        justify-content: center;
      }
      #marketGrid {
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      }
    }

    @media (max-width: 600px) {
      #topBar .bar-content {
        padding: 10px 5px;
      }
      #mainBox {
        padding: 10px 0 10px 0;
      }
      #authForm {
        padding: 22px 6vw 18px 6vw;
      }
      #authForm input[type="email"],
      #authForm input[type="password"] {
        margin-right: 0;
        margin-left: 0;
      }
      #authCenter {
        justify-content: center;
      }
      #marketGrid {
        grid-template-columns: 1fr 1fr;
        gap: 20px;
      }
      header h1 {
        font-size: 2.2rem;
      }
    }

    @media (max-width: 480px) {
      #marketGrid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>

<body>
  <!-- =============================================================
       Background Visuals
       ============================================================= -->
  <div id="bubbles-bg"></div>
  <div id="glow-overlay"></div>

  <!-- =============================================================
       Top Bar (hidden by default)
       ============================================================= -->
  <nav id="topBar" style="display: none;">
    <div class="bar-content">
      <img id="userAvatar" src="" alt="User Avatar" />
      <span id="userEmail"></span>
      <button id="changePassBtn" type="button">ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</button>
      <button id="signOutBtn" type="button">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>
    </div>
  </nav>

  <!-- =============================================================
       Change Password Modal
       ============================================================= -->
  <div id="changePassModal" style="display:none; position:fixed; z-index:200; left:0; top:0; width:100vw; height:100vh; background: rgba(0,0,0,0.4); align-items:center; justify-content:center;">
    <div class="modal-content" style="background:#002f2f; color:#e0f7f7; padding:30px 24px 20px 24px; border-radius:16px; box-shadow:0 0 30px #00fff7cc; min-width:320px; max-width:90vw; text-align:center; position:relative; font-family:'Cairo', sans-serif;">
      <button id="closeModalBtn" title="Ø¥ØºÙ„Ø§Ù‚" style="position:absolute; left:12px; top:12px; background:none; border:none; color:#00fff7; font-size:1.5rem; cursor:pointer;">Ã—</button>
      <h3 style="margin-top:0;">ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</h3>
      <p>Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©:</p>
      <input type="password" id="newPasswordInput" placeholder="ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø¬Ø¯ÙŠØ¯Ø©" minlength="6" required style="margin-bottom:18px; background:#18344a; color:#e0f7f7; border-radius:8px; border:none; padding:10px; width:90%; font-size:1rem; font-family:'Cairo', sans-serif;" />
      <div id="changePassMsg" style="color:#ff8080; min-height:18px; margin-bottom:10px;"></div>
      <button id="saveNewPassBtn" type="button" style="width:auto; min-width:120px; margin:0 8px;">Ø­ÙØ¸</button>
    </div>
  </div>

  <!-- =============================================================
       Main Box Wrapper
       ============================================================= -->
  <div id="mainBox">

    <!-- ===================== AUTH BOX ===================== -->
    <div id="authCenter" style="display:flex;">
      <form id="authForm">
        <h2>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h2>
        <label for="email">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
        <input type="email" id="email" placeholder="example@mail.com" required />
        <label for="password">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
        <input type="password" id="password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" required />
        <button id="signInBtn" type="button">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button>
        <button id="signUpBtn" type="button">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨</button>
        <div class="or-divider">Ø£Ùˆ</div>
        <button id="googleSignInBtn" type="button">
          <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" alt="Google" />
          <span>Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¹Ø¨Ø± Google</span>
        </button>
        <div id="message"></div>
      </form>
    </div>

    <!-- ===================== ROLE CHOOSER ===================== -->
    <div id="chooseRolePage">
      <h2 style="color:#00fff7; margin-bottom:30px; font-family:'Cairo',sans-serif;">Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ø­Ø³Ø§Ø¨</h2>
      <div style="display:flex; flex-direction:column; align-items:center; gap:40px;">
        <div style="display:flex; flex-direction:column; align-items:center;">
          <img src="https://cdn-icons-png.flaticon.com/512/6073/6073873.png" alt="Ø¯ÙƒØªÙˆØ±" style="width:120px; height:120px; border-radius:50%; box-shadow:0 0 20px #00fff7aa; margin-bottom:10px; background:#fff;" />
          <button id="chooseDoctorBtn" style="width:180px; font-size:1.3rem; margin-bottom:0;">Ø¯ÙƒØªÙˆØ±</button>
        </div>
        <div style="display:flex; flex-direction:column; align-items:center;">
          <img src="https://cdn-icons-png.flaticon.com/512/2922/2922510.png" alt="Ù…Ø±ÙŠØ¶" style="width:120px; height:120px; border-radius:50%; box-shadow:0 0 20px #00fff7aa; margin-bottom:10px; background:#fff;" />
          <button id="choosePatientBtn" style="width:180px; font-size:1.3rem;">Ù…Ø±ÙŠØ¶</button>
        </div>
      </div>
    </div>

    <!-- ===================== SITE CONTENT (hidden until role chosen) ===================== -->
    <header>
      <h1>Healthy Parental</h1>
    </header>

    <main>
      <!--
        Patient Form FIRST
        Then below it the rest of the site (images + text + market)
      -->
      <section id="patientFormBox">
        <form id="patientForm">
          <!-- Personal Information -->
          <div class="form-section">
            <h2>ğŸ“ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©</h2>
            <div class="form-group">
              <label for="full_name">Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„</label>
              <input type="text" id="full_name" name="full_name" placeholder="Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯ Ø¹Ù„ÙŠ" />
            </div>
            <div class="form-group">
              <label for="birth_date">ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯</label>
              <input type="date" id="birth_date" name="birth_date" />
            </div>
            <div class="form-group">
              <label for="gender">Ø§Ù„Ø¬Ù†Ø³</label>
              <select id="gender" name="gender">
                <option>Ø°ÙƒØ±</option>
                <option>Ø£Ù†Ø«Ù‰</option>
              </select>
            </div>
            <div class="form-group">
              <label for="phone">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label>
              <input type="tel" id="phone" name="phone" placeholder="+966 50 123 4567" />
            </div>
            <div class="form-group">
              <label for="address">Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</label>
              <input type="text" id="address" name="address" placeholder="Ø§Ù„Ø±ÙŠØ§Ø¶ØŒ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©" />
            </div>
            <div class="form-group">
              <label for="email_personal">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
              <input type="email" id="email_personal" name="email_personal" placeholder="example@gmail.com" />
            </div>
          </div>

          <hr style="border:none; height:1px; background:linear-gradient(90deg, transparent, #00fff7aa, transparent); margin:20px 0;" />

          <!-- Booking Information -->
          <div class="form-section">
            <h2>ğŸ“… Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø­Ø¬Ø²</h2>
            <div class="form-group">
              <label for="appointment_date">ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙˆØ¹Ø¯</label>
              <input type="date" id="appointment_date" name="appointment_date" />
            </div>
            <div class="form-group">
              <label for="preferred_time">Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…ÙØ¶Ù„</label>
              <input type="time" id="preferred_time" name="preferred_time" />
            </div>
            <div class="form-group">
              <label for="visit_type">Ù†ÙˆØ¹ Ø§Ù„Ø²ÙŠØ§Ø±Ø©</label>
              <select id="visit_type" name="visit_type">
                <option>ÙØ­Øµ Ø±ÙˆØªÙŠÙ†ÙŠ</option>
                <option>Ù…ØªØ§Ø¨Ø¹Ø©</option>
                <option>Ø­Ø§Ù„Ø© Ø·Ø§Ø±Ø¦Ø©</option>
              </select>
            </div>
          </div>

          <hr style="border:none; height:1px; background:linear-gradient(90deg, transparent, #00fff7aa, transparent); margin:20px 0;" />

          <!-- Medical Information -->
          <div class="form-section">
            <h2>ğŸ©º Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø·Ø¨ÙŠØ© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©</h2>
            <div class="form-group">
              <label for="main_complaint">Ø§Ù„Ø´ÙƒÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© (Ø³Ø¨Ø¨ Ø§Ù„Ø²ÙŠØ§Ø±Ø©)</label>
              <textarea id="main_complaint" name="main_complaint" placeholder="Ù…Ø«Ø§Ù„: Ø£Ù„Ù… ÙÙŠ Ø§Ù„ØµØ¯Ø± Ù…Ù†Ø° Ø£Ø³Ø¨ÙˆØ¹"></textarea>
            </div>
            <div class="form-group">
              <label for="illness_history">ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…Ø±Ø¶ Ø§Ù„Ø­Ø§Ù„ÙŠ</label>
              <textarea id="illness_history" name="illness_history" placeholder="Ù…Ø«Ø§Ù„: Ø¨Ø¯Ø£ Ø§Ù„Ø£Ù„Ù… Ù…Ù†Ø° 3 Ø£ÙŠØ§Ù…"></textarea>
            </div>
            <div class="form-group">
              <label for="chronic_diseases">Ø§Ù„Ø£Ù…Ø±Ø§Ø¶ Ø§Ù„Ù…Ø²Ù…Ù†Ø©</label>
              <textarea id="chronic_diseases" name="chronic_diseases" placeholder="Ù…Ø«Ø§Ù„: Ø¶ØºØ· Ø§Ù„Ø¯Ù…ØŒ Ø§Ù„Ø³ÙƒØ±ÙŠ"></textarea>
            </div>
            <div class="form-group">
              <label for="drug_allergy">Ø§Ù„Ø­Ø³Ø§Ø³ÙŠØ© Ù…Ù† Ø§Ù„Ø£Ø¯ÙˆÙŠØ©</label>
              <textarea id="drug_allergy" name="drug_allergy" placeholder="Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø£Ùˆ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø¯ÙˆÙŠØ©"></textarea>
            </div>
            <div class="form-group">
              <label for="current_medication">Ø§Ù„Ø£Ø¯ÙˆÙŠØ© Ø§Ù„Ø­Ø§Ù„ÙŠØ©</label>
              <textarea id="current_medication" name="current_medication" placeholder="Ù…Ø«Ø§Ù„: Ø£Ø³Ø¨Ø±ÙŠÙ† 81 Ù…Ù„Øº"></textarea>
            </div>
          </div>

          <button type="submit" class="submit-btn">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª</button>
          <div id="patientFormSuccess"></div>
        </form>
      </section>

      <!-- ===================== BELOW THE FORM: Site Content ===================== -->
      <section class="content-with-images">
        <div class="side-column">
          <img src="https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=500&q=90" alt="ØµØ­Ø© ÙˆØ·Ø¨ÙŠØ¹Ø©" />
          <img src="https://images.unsplash.com/photo-1504384308090-c894fdcc538d?auto=format&fit=crop&w=500&q=90" alt="Ø±ÙŠØ§Ø¶Ø©" />
        </div>
        <div class="center-text">
          Ø§Ù„ØµØ­Ø© Ø§Ù„Ø¬ÙŠØ¯Ø© Ø£Ø³Ø§Ø³ Ù„Ø­ÙŠØ§Ø© Ø³Ø¹ÙŠØ¯Ø©. Ø§Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ù†Ø¸Ø§Ù… ØºØ°Ø§Ø¦ÙŠ Ù…ØªÙˆØ§Ø²Ù†ØŒ ÙˆÙ…Ù…Ø§Ø±Ø³Ø© Ø§Ù„Ø±ÙŠØ§Ø¶Ø© Ø¨Ø§Ù†ØªØ¸Ø§Ù…ØŒ ÙˆØ§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù‚Ø³Ø· ÙƒØ§ÙÙ Ù…Ù† Ø§Ù„Ù†ÙˆÙ… ÙŠØ¹Ø²Ø² Ø±ÙØ§Ù‡ÙŠØªÙƒ ÙˆØ·Ø§Ù‚Ø© ÙŠÙˆÙ…Ùƒ.
        </div>
        <div class="side-column">
          <img src="https://images.unsplash.com/photo-1498837167922-ddd27525d352?auto=format&fit=crop&w=500&q=90" alt="ØºØ°Ø§Ø¡ ØµØ­ÙŠ" />
          <img src="https://images.unsplash.com/photo-1515377905703-c4788e51af15?auto=format&fit=crop&w=500&q=90" alt="Ø£Ø¨Ø­Ø§Ø« Ø·Ø¨ÙŠØ©" />
        </div>
      </section>

      <!-- ===================== Medicine Market Section ===================== -->
      <section id="market-section">
        <h2 style="color:#00fff7; text-align:center; margin-bottom:30px; font-family:'Cairo',sans-serif;">Ø³ÙˆÙ‚ Ø§Ù„Ø£Ø¯ÙˆÙŠØ©</h2>
        <div style="text-align:center; margin-bottom:20px;">
          <label for="currencySelect" style="font-size:1.1rem; color:#aaf0f0;">Ø§Ø®ØªØ± Ø§Ù„Ø¹Ù…Ù„Ø©:</label>
          <select id="currencySelect" style="font-size:1.1rem; border-radius:8px; padding:4px 12px; margin-right:8px; background:#002f2f; color:#e0f7f7; border:1px solid #00fff7;">
            <option value="egp">Ø¬Ù†ÙŠÙ‡ Ù…ØµØ±ÙŠ (EGP)</option>
            <option value="usd">Ø¯ÙˆÙ„Ø§Ø± Ø£Ù…Ø±ÙŠÙƒÙŠ (USD)</option>
          </select>
        </div>
        <div id="marketGrid"><!-- Cards will be rendered by JS --></div>
      </section>
    </main>
  </div>

  <!-- ===================== Floating Cart Icon ===================== -->
  <div class="cart-icon" title="Ø³Ù„Ø© Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª">
    ğŸ›’
    <span class="cart-count">0</span>
  </div>

  <!-- =============================================================
       Scripts (Firebase + App Logic)
       ============================================================= -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
  <script type="module">
    // -------------------- Firebase Setup --------------------
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-app.js";
    import {
      getAuth,
      signInWithEmailAndPassword,
      createUserWithEmailAndPassword,
      signOut,
      GoogleAuthProvider,
      signInWithPopup,
      updatePassword
    } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-auth.js";

    // Replace with your Firebase project if needed
    const firebaseConfig = {
      apiKey: "AIzaSyAtb4EIuHEZF-IoAWYiq3zE-qYuUvP4Wgo",
      authDomain: "sign-in-properly.firebaseapp.com",
      projectId: "sign-in-properly",
      storageBucket: "sign-in-properly.appspot.com",
      messagingSenderId: "431658776093",
      appId: "1:431658776093:web:df81018d7f4b76d74bf8f4",
      measurementId: "G-WC4VPBD4T4"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);

    // -------------------- DOM Elements --------------------
    const emailInput = document.getElementById('email');
    const passInput = document.getElementById('password');
    const signInBtn = document.getElementById('signInBtn');
    const signUpBtn = document.getElementById('signUpBtn');
    const googleSignInBtn = document.getElementById('googleSignInBtn');
    const message = document.getElementById('message');

    const authCenter = document.getElementById('authCenter');
    const header = document.querySelector('header');
    const main = document.querySelector('main');
    const topBar = document.getElementById('topBar');

    const userEmailSpan = document.getElementById('userEmail');
    const userAvatar = document.getElementById('userAvatar');
    const signOutBtn = document.getElementById('signOutBtn');
    const changePassBtn = document.getElementById('changePassBtn');

    // Modal elements
    const changePassModal = document.getElementById('changePassModal');
    const closeModalBtn = document.getElementById('closeModalBtn');
    const saveNewPassBtn = document.getElementById('saveNewPassBtn');
    const newPasswordInput = document.getElementById('newPasswordInput');
    const changePassMsg = document.getElementById('changePassMsg');

    // Patient form
    const patientForm = document.getElementById('patientForm');
    const patientFormSuccess = document.getElementById('patientFormSuccess');
    const patientFormBox = document.getElementById('patientFormBox');

    // Market/Currency elements
    const currencySelect = document.getElementById('currencySelect');
    const cartCount = document.querySelector('.cart-count');
    const cartIcon = document.querySelector('.cart-icon');

    // -------------------- Market Data --------------------
    const medicines = [
      {
        name: "Ø¨Ø§Ù†Ø§Ø¯ÙˆÙ„ Ø¥ÙƒØ³ØªØ±Ø§",
        img: "https://masterapi.witheldokan.com/storage/seif-pharmacies/uploads/171137.webp",
        egp: 30,
        usd: 0.65
      },
      {
        name: "ÙƒÙˆÙ†Ø¬Ø³ØªØ§Ù„",
        img: "https://cdn.sehatok.com/styles/1200x675sc/public/2023-11/congestal.jpg?itok=3i1C8J3x",
        egp: 27,
        usd: 0.58
      },
      {
        name: "ÙÙ„ÙˆØ±Ø³Øª",
        img: "https://www.3lagak.com/wp-content/uploads/2020/12/%D9%81%D9%84%D9%88%D8%B1%D8%B3%D8%AA-flurest.jpg",
        egp: 18,
        usd: 0.39
      },
      {
        name: "Ø£ÙˆØ¬Ù…Ù†ØªÙŠÙ† 1 Ø¬Ù…",
        img: "https://cdn.altebby.com/wp-content/uploads/2018/03/411650-2.jpg",
        egp: 120,
        usd: 2.6
      },
      {
        name: "ÙƒØªØ§ÙÙ„Ø§Ù… 50 Ù…Ø¬Ù…",
        img: "https://saydalia.net/wp-content/uploads/2018/04/%D9%83%D8%AA%D8%A7%D9%81%D9%84%D8%A7%D9%85-%D8%A3%D9%82%D8%B1%D8%A7%D8%B5.jpg",
        egp: 45,
        usd: 0.97
      },
      {
        name: "Ø¨Ø§Ø±Ø§Ø³ÙŠØªØ§Ù…ÙˆÙ„",
        img: "https://cdn.shopify.com/s/files/1/0526/1440/4503/products/Paracetamol500mg_1024x1024.jpg?v=1615149389",
        egp: 12,
        usd: 0.26
      },
      {
        name: "Ø£Ù…ÙˆÙƒØ³ÙŠÙ„ 500 Ù…Ø¬Ù…",
        img: "https://static.chemistwarehouse.com.au/ams/media/pi/76141/PI_303830.jpg",
        egp: 35,
        usd: 0.76
      },
      {
        name: "Ø³Ø¨ØªØ±ÙŠÙ† DS",
        img: "https://cdn.altebby.com/wp-content/uploads/2017/05/%D8%B3%D8%A8%D8%AA%D8%B1%D9%8A%D9%86.jpg",
        egp: 20,
        usd: 0.43
      }
    ];

    // -------------------- Cart Logic --------------------
    let cartItems = 0;

    function renderMarket(currency = 'egp') {
      const grid = document.getElementById('marketGrid');
      if (!grid) return;
      grid.innerHTML = '';

      medicines.forEach((med) => {
        const price = currency === 'egp' ? `${med.egp} Ø¬Ù†ÙŠÙ‡` : `${med.usd.toFixed(2)} $`;
        const card = document.createElement('div');
        card.className = 'medicine-card';
        card.innerHTML = `
          <img src="${med.img}" alt="${med.name}" />
          <div class="medicine-name">${med.name}</div>
          <div class="medicine-price">${price}</div>
          <button class="add-to-cart-btn">Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø³Ù„Ø©</button>
        `;

        const addBtn = card.querySelector('.add-to-cart-btn');
        addBtn.addEventListener('click', () => {
          cartItems++;
          cartCount.textContent = String(cartItems);
          cartIcon.style.transform = 'scale(1.2)';
          setTimeout(() => (cartIcon.style.transform = 'scale(1)'), 300);
        });

        grid.appendChild(card);
      });
    }

    // Currency switch
    if (currencySelect) {
      currencySelect.addEventListener('change', (e) => {
        renderMarket(e.target.value);
      });
    }

    // Init market
    renderMarket('egp');

    // -------------------- Avatar Helper --------------------
    function getAvatar(email, photoURL) {
      if (photoURL) return photoURL;
      const md5 = (val) => window.CryptoJS.MD5(val.trim().toLowerCase()).toString();
      return `https://www.gravatar.com/avatar/${md5(email)}?d=identicon`;
    }

    // -------------------- Auth Handlers --------------------
    signInBtn.addEventListener('click', () => {
      message.textContent = '';
      signInWithEmailAndPassword(auth, emailInput.value, passInput.value)
        .then(() => showContent())
        .catch((err) => (message.textContent = err.message));
    });

    signUpBtn.addEventListener('click', () => {
      message.textContent = '';
      createUserWithEmailAndPassword(auth, emailInput.value, passInput.value)
        .then(() => showContent())
        .catch((err) => (message.textContent = err.message));
    });

    if (googleSignInBtn) {
      googleSignInBtn.onclick = async () => {
        message.textContent = '';
        const provider = new GoogleAuthProvider();
        try {
          await signInWithPopup(auth, provider);
          showContent();
        } catch (err) {
          message.textContent = err.message;
        }
      };
    }

    // Show site content after login
    function showContent() {
      authCenter.style.display = 'none';
      document.getElementById('chooseRolePage').style.display = 'flex';
      header.classList.remove('visible');
      main.classList.remove('visible');
      topBar.style.display = 'block';

      const user = auth.currentUser;
      if (user) {
        userEmailSpan.textContent = user.email || '';
        userAvatar.src = getAvatar(user.email || '', user.photoURL || '');
      }
    }

    // Role selection
    // Doctor: show header/main and HIDE patient form box
    document.getElementById('chooseDoctorBtn').onclick = function () {
      document.getElementById('chooseRolePage').style.display = 'none';
      header.classList.add('visible');
      main.classList.add('visible');
      // Hide the patient form for doctors
      if (patientFormBox) patientFormBox.style.display = 'none';
      // Scroll to top so the homepage is shown
      window.scrollTo({ top: 0, behavior: 'smooth' });
    };

    // Patient: show header/main and SHOW patient form box and scroll to it
    document.getElementById('choosePatientBtn').onclick = function () {
      document.getElementById('chooseRolePage').style.display = 'none';
      header.classList.add('visible');
      main.classList.add('visible');
      if (patientFormBox) patientFormBox.style.display = 'block';
      // small timeout to ensure layout updated then scroll
      setTimeout(() => {
        const top = patientFormBox ? patientFormBox.getBoundingClientRect().top + window.scrollY - 20 : 0;
        window.scrollTo({ top, behavior: 'smooth' });
      }, 120);
    };

    // Sign out
    if (signOutBtn) {
      signOutBtn.onclick = () => {
        signOut(auth).then(() => {
          topBar.style.display = 'none';
          header.classList.remove('visible');
          main.classList.remove('visible');
          authCenter.style.display = 'flex';
          document.getElementById('authForm').reset();
          document.getElementById('chooseRolePage').style.display = 'none';
          cartItems = 0;
          cartCount.textContent = '0';
        });
      };
    }

    // Change password modal
    if (changePassBtn) {
      changePassBtn.onclick = () => {
        changePassMsg.textContent = '';
        newPasswordInput.value = '';
        changePassModal.style.display = 'flex';
        newPasswordInput.focus();
      };
    }

    if (closeModalBtn) {
      closeModalBtn.onclick = () => {
        changePassModal.style.display = 'none';
      };
    }

    if (saveNewPassBtn) {
      saveNewPassBtn.onclick = async () => {
        const user = auth.currentUser;
        const newPass = newPasswordInput.value;
        changePassMsg.textContent = '';
        changePassMsg.style.color = '#ff8080';
        if (!newPass || newPass.length < 6) {
          changePassMsg.textContent = 'ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† 6 Ø£Ø­Ø±Ù Ø£Ùˆ Ø£ÙƒØ«Ø±.';
          return;
        }
        try {
          await updatePassword(user, newPass);
          changePassMsg.style.color = '#00fff7';
          changePassMsg.textContent = 'ØªÙ… ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø¨Ù†Ø¬Ø§Ø­!';
          setTimeout(() => {
            changePassModal.style.display = 'none';
            changePassMsg.style.color = '#ff8080';
          }, 1200);
        } catch (err) {
          if (err.code === 'auth/requires-recent-login') {
            changePassMsg.textContent = 'ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù…Ø¬Ø¯Ø¯Ù‹Ø§ Ù„ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±.';
          } else {
            changePassMsg.textContent = err.message;
          }
        }
      };
    }

    // Close modal by clicking outside
    window.addEventListener('click', (event) => {
      if (event.target === changePassModal) {
        changePassModal.style.display = 'none';
      }
    });

    // -------------------- Patient Form Submission --------------------
    patientForm.addEventListener('submit', function (e) {
      e.preventDefault();
      // You can replace with actual submit to backend
      patientFormSuccess.textContent = 'ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙƒ Ø¨Ù†Ø¬Ø§Ø­! Ø³ÙŠØªØµÙ„ Ø¨Ùƒ Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø·Ø¨ÙŠ Ù‚Ø±ÙŠØ¨Ø§Ù‹.';
      this.reset();
      setTimeout(() => (patientFormSuccess.textContent = ''), 3000);
    });

    // -------------------- Visuals: Glow + Bubbles --------------------
    const glowOverlay = document.getElementById('glow-overlay');
    document.addEventListener('mousemove', (e) => {
      glowOverlay.style.background = `radial-gradient(circle at ${e.clientX}px ${e.clientY}px, rgba(0,255,247,0.2) 0%, transparent 15%)`;
    });

    const bubblesBg = document.getElementById('bubbles-bg');
    function randomBetween(a, b) {
      return Math.random() * (b - a) + a;
    }

    function createBubble() {
      const bubble = document.createElement('div');
      bubble.className = Math.random() > 0.5 ? 'bubble' : 'bubble bubble2';
      const size = randomBetween(40, 120);
      bubble.style.width = `${size}px`;
      bubble.style.height = `${size}px`;
      bubble.style.left = `${randomBetween(2, 98)}vw`;
      bubble.style.animationDuration = `${randomBetween(14, 28)}s`;
      bubble.style.animationDelay = `${randomBetween(0, 14)}s`;
      bubblesBg.appendChild(bubble);
      bubble.addEventListener('animationend', () => {
        bubble.remove();
        createBubble();
      });
    }

    for (let i = 0; i < 24; i++) createBubble();
  </script>
</body>
</html>
